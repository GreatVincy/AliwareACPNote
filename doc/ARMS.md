# 简介

- 业务实时监控服务(Application Real-Time Monoitoring Service)

  - 端到端一体化实时监控解决方案的**PaaS**级阿里云产品
  - 具有**秒级**的业务监控和响应能力

- 组件：

  - 数据收集，消息通道，实时计算，列式存储，以及在线报表等

- 场景：

  - 如系统监控，商品销售，网站分析

# 实现目标

1. 在该平台上快速搭建自己的应用监控能力。
2. 在此基础上进一步构建自己的业务的自定义监控场景。

# 产品优势

- 海量吞吐：在阿里内部的最大集群数据处理量超过每秒 15GB/s，后端数据结果写入超过 5GB/s。
- 秒级延迟：实时聚合统计计算达到秒级别延迟。解决流乱序，流延迟造成的数据异常问题。
- 持续计算能力：自我修复能力，自动修复故障节点，解决流乱序，流延迟造成的数据异常问题。
- 低学习成本：全图形化配置流程，不需要编写代码即可完成大部分的监控配置任务。
- 一站式集成：整合和封装了数据收集，消息通道，实时计算，列式存储，以及在线报表等多种先进互联网技术组件，为您提供实时监控的一站式解决方案。

# 产品功能

- 丰富的数据源支持

  - ECS Log：可直接在 ECS 的日志上抓取日志进行统计；
  - Loghub：支持直接拉去阿里云日志服务的 Loghub 数据；
  - MQ：可以直接从 MQ Topic 中直接读取数据(电商、物联网)
  - SDK：可以直接在程序中接入 SDK 中来推送数据。

- 灵活的实时计算任务定义

  - 支持拖拽式的实时计算模块化编程，支持绝大多数语言逻辑如通用数学计算，正则匹配，if/else 等；
  - 丰富的实时计算和存储算子支持，包括 Sum，Count，Max/Min，Sample，TopN，Count Distinct等。

- 稳定经济的时序和事件存储

  - 在线持续聚合数据，保证数据容量可控；
  - 智能分级存储存放策略；
  - 支持最多三级的下钻索引。

- 可定制的报警设置

  - 支持任意连续时间的滑动平均、最大值报警设置；
  - 支持报警内容的自定义；
  - 丰富的报警通道，如邮件，短信，钉钉等。

- 灵活的交互大盘定制

  - 丰富的展示控件，如柱线图、热力图、饼图、翻牌器等；
  - 支持大盘共享、全屏展示等。

- 多方位的前端监控功能

  - 支持页面打开速度（测速）监控；
  - 支持页面稳定性（JS Error）监控；
  - 支持外部服务调用成功率（API）监控。

- 丰富的自定义监控场景

  - 大量丰富的参考场景模板，如 Nginx 监控、异常监控、电商监控等。

- 灵活对接各类下游应用

  - 支持 Java，Python，Perl，C# 等 API 对接；
  - 支持其他大屏展示工具如 DataV 对接。

# 记重点

- 同步操作只会同步当前 Region 的 ECS。
- 首次同步需要进行 RAM 授权。
- 不同网络类型 Agent (Logtail)的安装方法不同
- 报警的优先级目前暂分为三种：警告、错误、致命。
- 一个交互式大盘可用于多个数据集的不同图标形势的展示
- ARMS 中的数据集都自带时间属性
- 数据清洗： 日志清洗是指对日志进行切分、静态 join 等，最终转化标准的 Key-Value(KV)
- Logtail：

  - 经典网络： 数据通过阿里云内网写入日志服务，不消耗公网带宽。适用于阿里云 ECS。
  - 专有网络： 数据通过阿里云专有网络写入日志服务。适用于阿里云ECS VPC
  - 公网： 数据通过公网写入日志服务，占用公网带宽。适用于非阿里云虚拟机或其它IDC

- 目前 ARMS 仅支持 ECS 日志源分组

- 同一个ECS分组的机器必须在同一个region。

- 同步 LogHub 之前用户必须对同步操作进行授权，否则无法同步。

- （LogHub）如果用户是 RAM 子账号登录，则无法授权；授权操作请确保是在主账号下操作；

- 监控任务： 数据源配置，日志清洗，报表与报警配置三大步骤

- 默认报警条件：

  - 为了避免报警的信息爆炸，相同报警持续报警，24小时内发送一条报警正在持续的消息。
  - 如果 5 分钟内没有重复报警则会发送恢复邮件，通知数据恢复正常。
  - 发送恢复邮件之后，报警的状态会重置。如果该报警再次出现，会认定为新的报警

- ID 类维度就相当于索引维度，在查询时候要给出明确的维度值，加速数据查询

- D 类维度不能为空，而维度可为空。目前 ARMS 中最多包含一个 ID 类维度和七个维度。

- 维度可独立使用或组合使用。

- 钻取的目的是改变维度层次，变换分析粒度。

- 任务详情主要包括：监控任务详情、数据集详情、任务运行详情

- 每配置一个报警也会生成一个数据集

- 数据集：

  - 时间粒度：默认为1分钟。
  - 实时数据：默认为关闭。如果开启，图表数据将会定时刷新，周期为1分钟。

- 暂停操作将会切断计算引擎与通道之间的连接，点击恢复将会重新建立连接，并继续上次的消费位点继续消费数据。

- 停止操作销毁了通道。

- 任务在"运行中"、"暂停"是不允许删除的，"新建"与"已停止"的任务可以删除

- 删除任务的同时将删除任务相关的配置、数据集、报表与报警。

- Apdex = (满意数 + 可容忍数 / 2) / 总样本量

- 在 ARMS 中，取页面首次渲染时间（First Paint Time）作为计算指标，默认定义 T 为 2秒。

- 错误率 = 错误样本量 / 总样本量

- API成功率 = 接口调用成功的样本量 / 总样本量

- ARMS 报表数据在服务器（公测）默认保存时间为半年。

- 在日志通道不延迟的情况下，统计计算的延迟在10秒之内

- ARMS 的实时计算引擎是 JStorm ，目前不支持直接开发 JStorm 给客户直接使用

- 特殊字符（不可见字符）可以作为分隔符
- 目前 ARMS 中最多包含一个 ID 类维度和七个维度。
- Count、Max、Sum、Count Distinct ,Rate
- 通用维度：适用于所有场景，但其中的维度是没有加速索引的（除非开启 ID 类维度，详细解释参见下文）
- 下钻维度：针对特定场景，当维度之间存在层级关系，如省->市->区，那么下钻类维度会针对每层的查询加速(索引)
- ID 类维度就相当于索引维度，在查询时候要给出明确的维度值，加速数据查询
- ARMS 中最多可以设置三个下钻维度。
- 提示：ECS数据源暂不支持从头消费
- 数据集定义了监控任务中采集日志的预聚合方式和持久化存储。在 ARMS 中通过简单的交互，就可以获得 ARMS 系统针对多维数据分析优化后的数据组织和存储方式。
- ARMS 提供下钻功能，可以从汇总数据深入到细节数据进行观察或新增维度。钻取的目的是改变维度层次，变换分析粒度。
- ARMS 中最多可以设置三个下钻维度。
- 下钻维度之间有层级关系。比如，要查看第二个维度，必须要先选择第一个维度的属性。
- 任务的运行过程包含：数据抓取、数据切分、数据聚合、数据存储。
- 操作频繁 系统默认限定操作间隔为15s 等待15s之后重试
- 实时性优先会实时返回您的数据，但可能会出现数据不齐导致的不准确。齐全度优先会在数据准确后再展示您的数据。
- 由于现在的聚合数据按秒级写入HBase，所以当前一分钟的数据不是该分钟的完整数据。
- 补零策略： 为您的数据中 null 值补零。
- ARMS 支持阿里云主子账号（RAM）访问体系
- ARMS前端监控平台主打 Web 端体验数据监控，通过页面打开速度（测速）、页面稳定性（JS Error）、外部服务调用成功率（API）三叉戟组合来监测 Web 页面的健康度.
- 访问量统计
- ARMS 报表数据在服务器保存多长时间？

  - 公测数据默认保存时间为半年。

- 目前 ARMS 仅提供日志作为数据来源

- ARMS 业务监控报表数据的延迟有多久？

  - 在日志通道不延迟的情况下，统计计算的延迟在10秒之内。

- ARMS 会修改或移动我本机上的日志文件吗？

  - 不会，ARMS 使用的 Logtail 客户端，只会按照您的配置对您 ECS 上的文件进行读取操作，不会对其进行任何形式的修改操作

- ARMS 的实时计算引擎 JStorm 能开发给用户直接使用么？

  - 我们目前不支持直接开发 JStorm 给客户直接使用。主要原因也是因为 ARMS 基于 JStorm 做了很多性能和 QoS 的优化。但是不排除未来我们经过优化以后开放 JStorm 接口直接运行。

- ARMS 的列示存储能直接暴露给用户直接使用么？

  - 不能。目前我们仅支持 Open API 的方式取数据。主要原因也是因为我们的存储方式是经过特定优化

- 特殊字符（不可见字符）可以作为分隔符

- JSON 格式的日志可以切分吗？

  - 可以，不过没有直接的专属 JSON 切分器来支持，需要使用逻辑表达式+KV 切分器配合使用

- 跨行日志（如异常堆栈）支持吗？

  - 暂不支持

- ARMS 默认支持 Aviator 表达式引擎，您可以完成对数据处理时的逻辑控制、赋值操作等。

- 支持的图标类型：翻牌器，表格，饼图，柱状图，条形图，折线图，面积图
